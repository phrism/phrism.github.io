<!-- build time: Tue Oct 17 2023 14:16:51 GMT+0000 (Coordinated Universal Time) --><!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="alternate" href="/rss.xml" title="personal blog" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="personal blog" type="application/atom+xml"><link rel="alternate" type="application/json" title="personal blog" href="https://blog.phrism.info/feed.json"><link rel="preconnect" href="https://lf9-cdn-tos.bytecdntp.com"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://unpkg.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.3.6"><script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.js"></script><meta name="keywords" content="self_develop"><link rel="canonical" href="https://blog.phrism.info/winAD-APT/"><title>winAD-APT</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">winAD-APT</h1><div class="meta"><span class="item" title="Created: 2023-10-14 12:33:47"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">Posted on</span><time itemprop="dateCreated datePublished" datetime="2023-10-14T12:33:47+08:00">2023-10-14</time></span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i></span><span class="text">Symbols count in article</span><span>2.9k</span><span class="text">words</span></span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i></span><span class="text">Reading time</span><span>3 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">phrism blog</a></li></ul><ul class="right" id="rightNav"><li class="item theme" @click="changeThemeByBtn"><i class="ic" :class="{'i-sun': !themeStatus,'i-moon': themeStatus}"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><img src="https://i.loli.net/2020/10/30/rjdhcSgEN8COBPA.jpg"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemlistelement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">Home</a></span></div><article class="post block" itemscope itemtype="http://schema.org/Article" lang="en"><link itemprop="mainEntityOfPage" href="https://blog.phrism.info/winAD-APT/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"><meta itemprop="name" content="phrism wang"><meta itemprop="description" content=", hacking and researching"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="personal blog"></span><div class="body md" itemprop="articleBody"><h1 id="windows-ad-auto-pentest-tool"><a class="anchor" href="#windows-ad-auto-pentest-tool">#</a> Windows AD Auto Pentest Tool</h1><h2 id="introduce"><a class="anchor" href="#introduce">#</a> Introduce</h2><p><img data-src="/self_develop/winAD-APT/0.png" alt=""><br>WinAD-APT, is the windwos active directory auto pentesting tool's abbreviation. When I do some windows activate pentesing research, I found that the tools for windows active directory pentesting is complex, so I write this tool to integrated the tools which is useful for all the usual payload and exploit, and provide a ui website so make ADpentesting more easily.</p><p>This tool is made of python streamlit, and mainly use linux command to do the pentesting, all the things we need to do is to full in the blanks like username and password, and click the button to exploit.</p><p>This tool is still being developed, it is recommand to add your command into this tool and customize your own tool</p><p>The tool is uploaded to github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3BocmlzbS9XaW5BRC1BUFQ=">winAD-APT</span> , it is welcome to download and test it, if you think the project is useful, a star is appreciated.</p><h2 id="usage"><a class="anchor" href="#usage">#</a> Usage</h2><p>When you run the <span class="exturl" data-url="aHR0cDovL1N0YXJ0LnB5">Start.py</span> file in the winAD-APT, your brower will automatically stared and lead you to the start page, you can set your target ip here<br><img data-src="/self_develop/winAD-APT/1.png" alt=""></p><p>The winAD-APT is made of 7 sub-parts:</p><ul><li>Nmap</li><li>InfoGather</li><li>Lateralpenetration</li><li>PermissionSploit</li><li>CrackHash</li><li>History</li><li>ViewFile</li></ul><p>In Nmap, you can start your nmap scan and custom the parameters in nmap, default is &quot;-sV -sC -A -Pn -T4&quot;, you can set your target domain here, and the open port information is essential for the lateral information gather.<br><img data-src="/self_develop/winAD-APT/7.png" alt=""></p><p>In InfoGather, you can use different tools like rpcclient, smbclient etc. to gather information according to the open port the nmap showed, you need to set your target ip and target domian before use this part of tools<br><img data-src="/self_develop/winAD-APT/2.png" alt=""></p><p>In Lateralpenetration, you can use common lateral pentetrstion tools like bloodhound, powerview or ldapmonitor, you can set the username and credentials you get in InforGather part, and all the credentails are stored by fault.<br><img data-src="/self_develop/winAD-APT/3.png" alt=""></p><p>In PermissionSploit, this part is mainly accomplished by winrm, and use windows commad instead of linux command, so there's not much auto pentesting tool here, there's some tips and command listed here for usage<br><img data-src="/self_develop/winAD-APT/6.png" alt=""></p><p>In CrackHash, you can paste your password hash here and use either hashcat ot john to crack the hash.<br><img data-src="/self_develop/winAD-APT/4.png" alt=""></p><p>In History, you can see all the history input and output here, so there's no need to clear your command line and lose some important information<br><img data-src="/self_develop/winAD-APT/8.png" alt=""></p><p>In ViewFile, you can view and edit the user and password file stored on your system, and save them from the ui, you can also use notes to take notes whenever you like, please do not forget to pres the save button!<br><img data-src="/self_develop/winAD-APT/5.png" alt=""></p><div class="tags"><a href="/tags/self-develop/" rel="tag"><i class="ic i-tag"></i>self_develop</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">Edited on</span><time title="Modified: 2023-10-17 13:24:30" itemprop="dateModified" datetime="2023-10-17T13:24:30+08:00">2023-10-17</time></span></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>phrism wang<i class="ic i-at"><em>@</em></i>personal blog</li><li class="link"><strong>Post link: </strong><a href="https://blog.phrism.info/winAD-APT/" title="winAD-APT">https://blog.phrism.info/winAD-APT/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/HTB-Drive-Walkthrough/" rel="next" itemprop="url" data-background-image="&#x2F;htb&#x2F;Drive&#x2F;0.png" title="HTB Drive Walkthrough"><span class="type">Next Post</span><h3>HTB Drive Walkthrough</h3></a></div></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#windows-ad-auto-pentest-tool"><span class="toc-number">1.</span> <span class="toc-text">Windows AD Auto Pentest Tool</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduce"><span class="toc-number">1.1.</span> <span class="toc-text">Introduce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#usage"><span class="toc-number">1.2.</span> <span class="toc-text">Usage</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="Related"></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="phrism wang" data-src="/assets/avatar.jpg"><p class="name" itemprop="name">phrism wang</p><div class="description" itemprop="description">hacking and researching</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">2</span><span class="name">posts</span></a></div><div class="item tags"><a href="/tags/"><span class="count">2</span><span class="name">tags</span></a></div></nav><div class="social"><a href="https://github.com/phrism" class="item github" rel="noopener external nofollow noreferrer" title="https:&#x2F;&#x2F;github.com&#x2F;phrism" target="_blank"><i class="ic i-github"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item dropdown"><a href="javascript:void(0);" rel="external nofollow noreferrer"><i class="ic i-user"></i>About</a><ul class="submenu"><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>About This Site</a></li><li class="item"><a href="/admiration/" rel="section"><i class="ic i-coffee"></i>Appreciation</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);" rel="external nofollow noreferrer"><i class="ic i-feather"></i>Posts</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>Friends</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/HTB-Drive-Walkthrough/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/winAD-APT/">winAD-APT</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/HTB-Drive-Walkthrough/">HTB Drive Walkthrough</a></span></li></ul></div><div class="rpost pjax"><h2>Recent Comments</h2><ul class="leancloud-recent-comment" id="new-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 -<span itemprop="copyrightYear">2023</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">phrism wang @ phrism blog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="Symbols count total">7k words</span><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="Reading time total">7 mins.</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & Theme.<a href="https://github.com/theme-shoka-x/hexo-theme-shokaX/" rel="noopener external nofollow noreferrer" target="_blank">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"winAD-APT/",favicon:{show:"(●´3｀●) Here we go again.",hide:"(´Д｀) It's a disaster!"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,chart:!1,copy_tex:!1,katex:!1,mermaid:!1,audio:void 0,fancybox:!0,nocopy:!1,outime:!0,template:'<div class="note warning"><p><span class="label warning">Article Timeliness Alert</span><br>This is an article published {{publish}} days ago and last updated {{updated}} days ago. Some information may have changed, so please be careful to screen it.</p></div>',quiz:{choice:"Multiple Choice",multiple:"Multiple Answer",true_false:"True/False",essay:"Questions",gap_fill:"Gap Filling",mistake:"Wrong Answer"},ignores:[e=>e.includes("#"),e=>new RegExp(LOCAL.path+"$").test(e),[]]}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=default,fetch"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/pace/1.0.2/pace.min.js"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/algoliasearch/4.12.1/algoliasearch-lite.umd.min.js"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/instantsearch.js/4.39.0/instantsearch.production.min.js"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/quicklink/2.2.0/quicklink.umd.min.js"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/??jquery/3.5.1/jquery.min.js,fancybox/3.5.7/jquery.fancybox.min.js,justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" async></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/KaTeX/0.15.2/contrib/copy-tex.min.js" async></script><script src="/js/app.js?v=0.3.6"></script></body></html><!-- rebuild by hexo-renderer-multi-next-markdown-it -->